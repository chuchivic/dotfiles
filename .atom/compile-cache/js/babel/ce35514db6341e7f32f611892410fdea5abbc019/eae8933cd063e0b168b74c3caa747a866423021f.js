
"use strict";
var _ = require("lodash");
var createStylelint = require("./createStylelint");
var postcss = require("postcss");
var path = require("path");

module.exports = postcss.plugin("stylelint", function (options) {
  options = options || {};

  var tailoredOptions /*: Object*/ = options.rules ? { config: options } : options;
  var stylelint = createStylelint(tailoredOptions);

  return function (root, result) {
    var filePath = options.from || _.get(root, "source.input.file");
    if (filePath !== undefined && !path.isAbsolute(filePath)) {
      filePath = path.join(process.cwd(), filePath);
    }

    return stylelint._lintSource({
      filePath: filePath,
      existingPostcssResult: result
    });
  };
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2plc3VzLy5hdG9tL3BhY2thZ2VzL2xpbnRlci1zdHlsZWxpbnQvbm9kZV9tb2R1bGVzL3N0eWxlbGludC9saWIvcG9zdGNzc1BsdWdpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQ0EsWUFBWSxDQUFBO0FBQ1osSUFBTSxDQUFDLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxDQUFBO0FBQzNCLElBQU0sZUFBZSxHQUFHLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQyxDQUFBO0FBQ3BELElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQTtBQUNsQyxJQUFNLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUE7O0FBRTVCLE1BQU0sQ0FBQyxPQUFPLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxXQUFXLEVBQUUsVUFBVSxPQUFPLEVBQUU7QUFDOUQsU0FBTyxHQUFHLE9BQU8sSUFBSSxFQUFFLENBQUE7O0FBRXZCLE1BQU0sZUFBZSxnQkFBZSxPQUFPLENBQUMsS0FBSyxHQUM3QyxFQUFFLE1BQU0sRUFBRSxPQUFPLEVBQUUsR0FDbkIsT0FBTyxDQUFBO0FBQ1gsTUFBTSxTQUFTLEdBQUcsZUFBZSxDQUFDLGVBQWUsQ0FBQyxDQUFBOztBQUVsRCxTQUFPLFVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBSztBQUN2QixRQUFJLFFBQVEsR0FBRyxPQUFPLENBQUMsSUFBSSxJQUFJLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLG1CQUFtQixDQUFDLENBQUE7QUFDL0QsUUFBSSxRQUFRLEtBQUssU0FBUyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUMsRUFBRTtBQUN4RCxjQUFRLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsR0FBRyxFQUFFLEVBQUUsUUFBUSxDQUFDLENBQUE7S0FDOUM7O0FBRUQsV0FBTyxTQUFTLENBQUMsV0FBVyxDQUFDO0FBQzNCLGNBQVEsRUFBUixRQUFRO0FBQ1IsMkJBQXFCLEVBQUUsTUFBTTtLQUM5QixDQUFDLENBQUE7R0FDSCxDQUFBO0NBQ0YsQ0FBQyxDQUFBIiwiZmlsZSI6Ii9ob21lL2plc3VzLy5hdG9tL3BhY2thZ2VzL2xpbnRlci1zdHlsZWxpbnQvbm9kZV9tb2R1bGVzL3N0eWxlbGludC9saWIvcG9zdGNzc1BsdWdpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cInVzZSBzdHJpY3RcIlxuY29uc3QgXyA9IHJlcXVpcmUoXCJsb2Rhc2hcIilcbmNvbnN0IGNyZWF0ZVN0eWxlbGludCA9IHJlcXVpcmUoXCIuL2NyZWF0ZVN0eWxlbGludFwiKVxuY29uc3QgcG9zdGNzcyA9IHJlcXVpcmUoXCJwb3N0Y3NzXCIpXG5jb25zdCBwYXRoID0gcmVxdWlyZShcInBhdGhcIilcblxubW9kdWxlLmV4cG9ydHMgPSBwb3N0Y3NzLnBsdWdpbihcInN0eWxlbGludFwiLCBmdW5jdGlvbiAob3B0aW9ucykge1xuICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuXG4gIGNvbnN0IHRhaWxvcmVkT3B0aW9ucy8qOiBPYmplY3QqLyA9IG9wdGlvbnMucnVsZXNcbiAgICA/IHsgY29uZmlnOiBvcHRpb25zIH1cbiAgICA6IG9wdGlvbnNcbiAgY29uc3Qgc3R5bGVsaW50ID0gY3JlYXRlU3R5bGVsaW50KHRhaWxvcmVkT3B0aW9ucylcblxuICByZXR1cm4gKHJvb3QsIHJlc3VsdCkgPT4ge1xuICAgIGxldCBmaWxlUGF0aCA9IG9wdGlvbnMuZnJvbSB8fCBfLmdldChyb290LCBcInNvdXJjZS5pbnB1dC5maWxlXCIpXG4gICAgaWYgKGZpbGVQYXRoICE9PSB1bmRlZmluZWQgJiYgIXBhdGguaXNBYnNvbHV0ZShmaWxlUGF0aCkpIHtcbiAgICAgIGZpbGVQYXRoID0gcGF0aC5qb2luKHByb2Nlc3MuY3dkKCksIGZpbGVQYXRoKVxuICAgIH1cblxuICAgIHJldHVybiBzdHlsZWxpbnQuX2xpbnRTb3VyY2Uoe1xuICAgICAgZmlsZVBhdGgsXG4gICAgICBleGlzdGluZ1Bvc3Rjc3NSZXN1bHQ6IHJlc3VsdCxcbiAgICB9KVxuICB9XG59KVxuIl19